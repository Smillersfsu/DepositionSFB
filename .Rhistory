sed$Year <- as.character(sed$Year)
sed$Distance <-as.numeric(sed$Distance)
veg <- dataset_veg %>% mutate(Avg.Ht = ifelse(is.na(Avg.Ht), 0, Avg.Ht))
veg <- dataset_veg %>% mutate(Max.Ht = ifelse(is.na(Max.Ht), 0, Max.Ht))
veg$Season <- str_replace_all(veg$Season, " ", "")
veg$Distance <- str_replace_all(veg$Distance, " ", "")
veg$Transect <- str_replace_all(veg$Transect, " ", "")
veg$Year <- str_replace_all(veg$Year, " ", "")
veg$Month <- str_replace_all(veg$Month, " ", "")
veg$Plot.ID <- str_replace_all(veg$Plot.ID, " ", "")
# load data
dataset_sed <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_sediment_pad_data (project).csv")
dataset_veg <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_1m_vegetation_data (project).csv")
sed <- dataset_sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed <- dataset_sed %>%
select(-Date.removed.from.field, -Date.placed.in.field)
sed <- sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed$Plot.ID <- paste(sed$Transect, sed$Distance)
sed$Season <- str_replace_all(sed$Season, " ", "")
sed$Distance <- str_replace_all(sed$Distance, " ", "")
sed$Transect <- str_replace_all(sed$Transect, " ", "")
sed$Year <- str_replace_all(sed$Year, " ", "")
sed$Month <- str_replace_all(sed$Month, " ", "")
sed$FluxAvgRep <- str_replace_all(sed$FluxAvgRep, " ", "")
sed$Plot.ID <- str_replace_all(sed$Plot.ID, " ", "")
sed$FluxAvgRep <-as.numeric(sed$FluxAvgRep)
sed$FluxAvgRep <- round(sed$FluxAvgRep)
sed$Year <- as.character(sed$Year)
sed$Distance <-as.numeric(sed$Distance)
veg <- dataset_veg %>% mutate(Avg.Ht = ifelse(is.na(Avg.Ht), 0, Avg.Ht))
veg <- dataset_veg %>% mutate(Max.Ht = ifelse(is.na(Max.Ht), 0, Max.Ht))
veg$Season <- str_replace_all(veg$Season, " ", "")
veg$Distance <- str_replace_all(veg$Distance, " ", "")
veg$Transect <- str_replace_all(veg$Transect, " ", "")
veg$Year <- str_replace_all(veg$Year, " ", "")
veg$Month <- str_replace_all(veg$Month, " ", "")
veg$Plot.ID <- str_replace_all(veg$Plot.ID, " ", "")
# load data
dataset_sed <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_sediment_pad_data (project).csv")
dataset_veg <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_1m_vegetation_data (project).csv")
sed <- dataset_sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed <- dataset_sed %>%
select(-Date.removed.from.field, -Date.placed.in.field)
sed <- sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed$Plot.ID <- paste(sed$Transect, sed$Distance)
sed$Season <- str_replace_all(sed$Season, " ", "")
sed$Distance <- str_replace_all(sed$Distance, " ", "")
sed$Transect <- str_replace_all(sed$Transect, " ", "")
sed$Year <- str_replace_all(sed$Year, " ", "")
sed$Month <- str_replace_all(sed$Month, " ", "")
sed$FluxAvgRep <- str_replace_all(sed$FluxAvgRep, " ", "")
sed$Plot.ID <- str_replace_all(sed$Plot.ID, " ", "")
sed$FluxAvgRep <-as.numeric(sed$FluxAvgRep)
sed$FluxAvgRep <- round(sed$FluxAvgRep)
sed$Year <- as.character(sed$Year)
sed$Distance <-as.numeric(sed$Distance)
veg$Plot.ID <- paste(veg$Transect, veg$Distance)
veg <- dataset_veg %>% mutate(Avg.Ht = ifelse(is.na(Avg.Ht), 0, Avg.Ht))
veg <- dataset_veg %>% mutate(Max.Ht = ifelse(is.na(Max.Ht), 0, Max.Ht))
veg$Season <- str_replace_all(veg$Season, " ", "")
veg$Distance <- str_replace_all(veg$Distance, " ", "")
veg$Transect <- str_replace_all(veg$Transect, " ", "")
veg$Year <- str_replace_all(veg$Year, " ", "")
veg$Month <- str_replace_all(veg$Month, " ", "")
veg$Plot.ID <- str_replace_all(veg$Plot.ID, " ", "")
# load data
dataset_sed <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_sediment_pad_data (project).csv")
dataset_veg <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_1m_vegetation_data (project).csv")
sed <- dataset_sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed <- dataset_sed %>%
select(-Date.removed.from.field, -Date.placed.in.field)
sed <- sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed$Plot.ID <- paste(sed$Transect, sed$Distance)
sed$Season <- str_replace_all(sed$Season, " ", "")
sed$Distance <- str_replace_all(sed$Distance, " ", "")
sed$Transect <- str_replace_all(sed$Transect, " ", "")
sed$Year <- str_replace_all(sed$Year, " ", "")
sed$Month <- str_replace_all(sed$Month, " ", "")
sed$FluxAvgRep <- str_replace_all(sed$FluxAvgRep, " ", "")
sed$Plot.ID <- str_replace_all(sed$Plot.ID, " ", "")
sed$FluxAvgRep <-as.numeric(sed$FluxAvgRep)
sed$FluxAvgRep <- round(sed$FluxAvgRep)
sed$Year <- as.character(sed$Year)
sed$Distance <-as.numeric(sed$Distance)
veg$Plot.ID <- paste(veg$Transect, veg$Distance)
veg <- dataset_veg %>% mutate(Avg.Ht = ifelse(is.na(Avg.Ht), 0, Avg.Ht))
veg <- dataset_veg %>% mutate(Max.Ht = ifelse(is.na(Max.Ht), 0, Max.Ht))
veg$Season <- str_replace_all(veg$Season, " ", "")
veg$Distance <- str_replace_all(veg$Distance, " ", "")
veg$Transect <- str_replace_all(veg$Transect, " ", "")
veg$Year <- str_replace_all(veg$Year, " ", "")
veg$Month <- str_replace_all(veg$Month, " ", "")
veg$Plot.ID <- str_replace_all(veg$Plot.ID, " ", "")
# load data
dataset_sed <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_sediment_pad_data (project).csv")
dataset_veg <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_1m_vegetation_data (project).csv")
sed <- dataset_sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed <- dataset_sed %>%
select(-Date.removed.from.field, -Date.placed.in.field)
sed <- sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed$Plot.ID <- paste(sed$Transect, sed$Distance)
sed$Season <- str_replace_all(sed$Season, " ", "")
sed$Distance <- str_replace_all(sed$Distance, " ", "")
sed$Transect <- str_replace_all(sed$Transect, " ", "")
sed$Year <- str_replace_all(sed$Year, " ", "")
sed$Month <- str_replace_all(sed$Month, " ", "")
sed$FluxAvgRep <- str_replace_all(sed$FluxAvgRep, " ", "")
sed$Plot.ID <- str_replace_all(sed$Plot.ID, " ", "")
sed$FluxAvgRep <-as.numeric(sed$FluxAvgRep)
sed$FluxAvgRep <- round(sed$FluxAvgRep)
sed$Year <- as.character(sed$Year)
sed$Distance <-as.numeric(sed$Distance)
veg$Plot.ID <- paste(veg$Transect, veg$Distance)
veg <- dataset_veg %>% mutate(Avg.Ht = ifelse(is.na(Avg.Ht), 0, Avg.Ht))
veg <- dataset_veg %>% mutate(Max.Ht = ifelse(is.na(Max.Ht), 0, Max.Ht))
veg$Season <- str_replace_all(veg$Season, " ", "")
veg$Distance <- str_replace_all(veg$Distance, " ", "")
veg$Transect <- str_replace_all(veg$Transect, " ", "")
veg$Year <- str_replace_all(veg$Year, " ", "")
veg$Month <- str_replace_all(veg$Month, " ", "")
veg$Year <- as.character(veg$Year)
veg$Cover <-as.numeric(veg$Cover)
veg$Distance <-as.numeric(veg$Distance)
str(sed)
str(veg)
# load data
dataset_sed <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_sediment_pad_data (project).csv")
dataset_veg <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_1m_vegetation_data (project).csv")
sed <- dataset_sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed <- dataset_sed %>%
select(-Date.removed.from.field, -Date.placed.in.field)
sed <- sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed$Plot.ID <- paste(sed$Transect, sed$Distance)
sed$Season <- str_replace_all(sed$Season, " ", "")
sed$Distance <- str_replace_all(sed$Distance, " ", "")
sed$Transect <- str_replace_all(sed$Transect, " ", "")
sed$Year <- str_replace_all(sed$Year, " ", "")
sed$Month <- str_replace_all(sed$Month, " ", "")
sed$FluxAvgRep <- str_replace_all(sed$FluxAvgRep, " ", "")
sed$Plot.ID <- str_replace_all(sed$Plot.ID, " ", "")
sed$FluxAvgRep <-as.numeric(sed$FluxAvgRep)
sed$FluxAvgRep <- round(sed$FluxAvgRep)
sed$Year <- as.character(sed$Year)
sed$Distance <-as.numeric(sed$Distance)
veg$Plot.ID <- paste(veg$Transect, veg$Distance)
veg <- dataset_veg %>% mutate(Avg.Ht = ifelse(is.na(Avg.Ht), 0, Avg.Ht))
veg <- dataset_veg %>% mutate(Max.Ht = ifelse(is.na(Max.Ht), 0, Max.Ht))
veg$Season <- str_replace_all(veg$Season, " ", "")
veg$Distance <- str_replace_all(veg$Distance, " ", "")
veg$Transect <- str_replace_all(veg$Transect, " ", "")
veg$Year <- str_replace_all(veg$Year, " ", "")
veg$Month <- str_replace_all(veg$Month, " ", "")
veg$Year <- as.character(veg$Year)
veg$Cover <-as.numeric(veg$Cover)
veg$Distance <-as.numeric(veg$Distance)
str(sed)
str(veg)
# load data
dataset_sed <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_sediment_pad_data (project).csv")
dataset_veg <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_1m_vegetation_data (project).csv")
sed <- dataset_sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed <- dataset_sed %>%
select(-Date.removed.from.field, -Date.placed.in.field)
sed <- sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed$Plot.ID <- paste(sed$Transect, sed$Distance)
veg$Plot.ID <- paste(veg$Transect, veg$Distance)
sed$Season <- str_replace_all(sed$Season, " ", "")
sed$Distance <- str_replace_all(sed$Distance, " ", "")
sed$Transect <- str_replace_all(sed$Transect, " ", "")
sed$Year <- str_replace_all(sed$Year, " ", "")
sed$Month <- str_replace_all(sed$Month, " ", "")
sed$FluxAvgRep <- str_replace_all(sed$FluxAvgRep, " ", "")
sed$Plot.ID <- str_replace_all(sed$Plot.ID, " ", "")
sed$FluxAvgRep <-as.numeric(sed$FluxAvgRep)
sed$FluxAvgRep <- round(sed$FluxAvgRep)
sed$Year <- as.character(sed$Year)
sed$Distance <-as.numeric(sed$Distance)
veg <- dataset_veg %>% mutate(Avg.Ht = ifelse(is.na(Avg.Ht), 0, Avg.Ht))
veg <- dataset_veg %>% mutate(Max.Ht = ifelse(is.na(Max.Ht), 0, Max.Ht))
veg$Season <- str_replace_all(veg$Season, " ", "")
veg$Distance <- str_replace_all(veg$Distance, " ", "")
veg$Transect <- str_replace_all(veg$Transect, " ", "")
veg$Year <- str_replace_all(veg$Year, " ", "")
veg$Month <- str_replace_all(veg$Month, " ", "")
veg$Year <- as.character(veg$Year)
veg$Cover <-as.numeric(veg$Cover)
veg$Distance <-as.numeric(veg$Distance)
str(sed)
str(veg)
# load data
dataset_sed <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_sediment_pad_data (project).csv")
dataset_veg <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_1m_vegetation_data (project).csv")
sed <- dataset_sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed <- dataset_sed %>%
select(-Date.removed.from.field, -Date.placed.in.field)
sed <- sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
#sed$Plot.ID <- paste(sed$Transect, sed$Distance)
#veg$Plot.ID <- paste(veg$Transect, veg$Distance)
sed$Season <- str_replace_all(sed$Season, " ", "")
sed$Distance <- str_replace_all(sed$Distance, " ", "")
sed$Transect <- str_replace_all(sed$Transect, " ", "")
sed$Year <- str_replace_all(sed$Year, " ", "")
sed$Month <- str_replace_all(sed$Month, " ", "")
sed$FluxAvgRep <- str_replace_all(sed$FluxAvgRep, " ", "")
sed$Plot.ID <- str_replace_all(sed$Plot.ID, " ", "")
# load data
dataset_sed <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_sediment_pad_data (project).csv")
dataset_veg <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_1m_vegetation_data (project).csv")
sed <- dataset_sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed <- dataset_sed %>%
select(-Date.removed.from.field, -Date.placed.in.field)
sed <- sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
#sed$Plot.ID <- paste(sed$Transect, sed$Distance)
#veg$Plot.ID <- paste(veg$Transect, veg$Distance)
sed$Season <- str_replace_all(sed$Season, " ", "")
sed$Distance <- str_replace_all(sed$Distance, " ", "")
sed$Transect <- str_replace_all(sed$Transect, " ", "")
sed$Year <- str_replace_all(sed$Year, " ", "")
sed$Month <- str_replace_all(sed$Month, " ", "")
sed$FluxAvgRep <- str_replace_all(sed$FluxAvgRep, " ", "")
#sed$Plot.ID <- str_replace_all(sed$Plot.ID, " ", "")
sed$FluxAvgRep <-as.numeric(sed$FluxAvgRep)
sed$FluxAvgRep <- round(sed$FluxAvgRep)
sed$Year <- as.character(sed$Year)
sed$Distance <-as.numeric(sed$Distance)
veg <- dataset_veg %>% mutate(Avg.Ht = ifelse(is.na(Avg.Ht), 0, Avg.Ht))
veg <- dataset_veg %>% mutate(Max.Ht = ifelse(is.na(Max.Ht), 0, Max.Ht))
veg$Season <- str_replace_all(veg$Season, " ", "")
veg$Distance <- str_replace_all(veg$Distance, " ", "")
veg$Transect <- str_replace_all(veg$Transect, " ", "")
veg$Year <- str_replace_all(veg$Year, " ", "")
veg$Month <- str_replace_all(veg$Month, " ", "")
veg$Year <- as.character(veg$Year)
veg$Cover <-as.numeric(veg$Cover)
veg$Distance <-as.numeric(veg$Distance)
str(sed)
str(veg)
sed_mean <- mean(sed$FluxAvgRep, na.rm = TRUE)
sed_mean
sed_max  <- max(sed$FluxAvgRep, na.rm = TRUE)
sed_max
sed_min  <- min(sed$FluxAvgRep, na.rm = TRUE)
sed_min
sed_sd <-sd(sed$FluxAvgRep, na.rm =TRUE)
sed_sd
SAPA_time_space <- ggplot(data=veg, aes(x=Distance, y=Max.Ht, color=Site)) + geom_point()
SAPA_time_space
sed_space <-ggplot(data=sed, aes(x=Distance, y=FluxAvgRep, color=Site)) +geom_point() + geom_jitter(width = 0.2, height = 0.2, alpha = 0.6) + theme_minimal() +
coord_cartesian(ylim = c(0, 357))
sed_space
sed_time <-ggplot(data=sed, aes(x=Season, y=FluxAvgRep, color=Site)) + geom_point() + geom_jitter(width = 0.2, height = 0.2, alpha = 0.6) + theme_minimal() +
coord_cartesian(ylim = c(0, 357))
sed_time
SAPA_height <- ggplot(veg, aes(x=Max.Ht,fill=Season)) + geom_boxplot()
SAPA_height
SAPA_cover <- ggplot(veg, aes(x=Cover, fill = Season)) + geom_boxplot()
SAPA_cover
SAPA_Site_cover <- ggplot(veg, aes(x= Cover, fill = Site)) + geom_boxplot()
SAPA_Site_cover
SAPA_Site_mxht <- ggplot(veg, aes(x = Max.Ht, fill = Site)) + geom_boxplot()
SAPA_Site_mxht
#check the data for normality, Max.Ht
SAPA_Maxht_Site_Normality <-ggplot(veg, aes(x=Max.Ht)) + geom_histogram(binwidth = 0.5)
SAPA_Maxht_Site_Normality
#check the data for normality, Avg.ht
SAPA_Avght_Site_Normality <-ggplot(veg, aes(x=Avg.Ht)) + geom_histogram(binwidth = 0.5)
SAPA_Avght_Site_Normality
#check the data for normality, Cover
SAPA_Cover_Site_Normality <-ggplot(veg, aes(x=Cover)) + geom_histogram(binwidth = 0.5)
SAPA_Cover_Site_Normality
sed_SAPA <- merge(sed, veg, by = c("Site", "Season", "Distance", "Transect", "Year", "Month"), all = FALSE)
#separating the main dataframe into two site sets
CMsed_veg <- subset(sed_SAPA, Site == "Corte Madera")
CMsed_veg
SPsed_veg <- subset(sed_SAPA, Site == "San Pablo")
SPsed_veg
sed_year <- ggplot(sed, aes(x= Year, y= FluxAvgRep, color= Site)) +geom_point()
sed_year
sed_Siteseason <- ggplot(sed, aes(x= Site, y=FluxAvgRep, color = Season)) +geom_point() + geom_boxplot()
sed_Siteseason
sed_site <- ggplot(sed, aes(x=Site, y=FluxAvgRep)) +geom_point() + geom_boxplot()
sed_site
sedvegCM <- ggplot(CMsed_veg, aes(x = Distance, y = FluxAvgRep, color = Season)) + geom_point()
sedvegCM
sedvegSP <- ggplot(SPsed_veg, aes(x = Distance, y = FluxAvgRep, color = Season)) + geom_point()
sedvegSP
sed_site_normality <- ggplot(sed, aes(x=FluxAvgRep)) +geom_histogram(binwidth = 0.5)
sed_site_normality
t.test(Max.Ht~Site,alternative ="two.sided", var.equal = TRUE, data=sed_SAPA)
t.test(FluxAvgRep~Site,alternative ="two.sided", var.equal = TRUE, data=sed_SAPA)
sedvegglm <-glm(FluxAvgRep~Max.Ht, family = "poisson", data=sed_SAPA)
sedvegglm
sedvegglm_AIC_text <- paste("AIC: 11710")
sedvegglm_AIC_text
sedvegglm_coefficient_Max.Ht <- paste("Coefficient for Max Height: -0.0177 ")
sedvegglm_coefficient_Max.Ht
#Add model predictions
sed_SAPA$predicted <-predict(sedvegglm, type = "response")
sedvegglm <-glm(FluxAvgRep~Max.Ht, family = "poisson", data=sed_SAPA)
sedvegglm
sedvegglm_AIC_text <- paste("AIC: 3788")
sedvegglm_AIC_text
sedvegglm_coefficient_Max.Ht <- paste("Coefficient for Max Height: -0.003517 ")
sedvegglm_coefficient_Max.Ht
#Add model predictions
sed_SAPA$predicted <-predict(sedvegglm, type = "response")
#Add model predictions
sed_SAPA_used <- na.omit(sed_SAPA)
sed_SAPA$predicted <-predict(sedvegglm, type = "response")
sedvegglm <-glm(FluxAvgRep~Max.Ht, family = "poisson", data=sed_SAPA)
sedvegglm
sedvegglm_AIC_text <- paste("AIC: 3788")
sedvegglm_AIC_text
sedvegglm_coefficient_Max.Ht <- paste("Coefficient for Max Height: -0.003517 ")
sedvegglm_coefficient_Max.Ht
#Add model predictions
sed_SAPA$predicted <-predict(sedvegglm, type = "response")
library(glmmTMB)
sed_glmm = glmmTMB(FluxAvgRep~Max.Ht + Dist + Avg.Ht + (1|Season) + (1|Site) +(1|Year), family = poisson, data=sed_SAPA)
library(glmmTMB)
sed_glmm = glmmTMB(FluxAvgRep~Max.Ht + Distance + Avg.Ht + (1|Season) + (1|Site) +(1|Year), family = poisson, data=sed_SAPA)
summary(sed_glmm)
AIC(sedvegglm, sedvegglm2, sed_glmm)
library(glmmTMB)
sed_glmm = glmmTMB(FluxAvgRep~Max.Ht + Distance + Avg.Ht + (1|Season) + (1|Site) +(1|Year), family = poisson, data=sed_SAPA)
summary(sed_glmm)
AIC(sed_glmm)
sed_glmmSP = glmmTMB(FluxAvgRep~Max.Ht + Cover + Dist + Avg.Ht + (1|Season) + (1|Year), family = poisson, data=SPsed_veg)
sed_glmmSP = glmmTMB(FluxAvgRep~Max.Ht + Cover + Distance + Avg.Ht + (1|Season) + (1|Year), family = poisson, data=SPsed_veg)
summary(sed_glmmSP)
sed_glmmCM = glmmTMB(FluxAvgRep~Max.Ht + Cover + Distance + Avg.Ht + (1|Season) + (1|Year), family = poisson, data=CMsed_veg)
summary(sed_glmmCM)
sed1_cor <- cor_test(FluxAvgRep, Max.Ht, data=sed_SAPA)
#correlation coefficient
r <- sed1_cor$cor
r
#converting sed_SAPA into a matrix
sed2 <- as.matrix(subset(sed_SAPA, select =-c(FluxAvgRep)))
# correlation coefficient
sed3 <- cor(sed2, method = "pearson")
bartlett.test(FluxAvgRep~Site, data=sed_SAPA)
bartlett.test(FluxAvgRep~Season, data=sed_SAPA)
sed_aov <- aov(FluxAvgRep ~ Max.Ht  + Season + Max.Ht*Season, data=sed_SAPA)
summary(sed_aov)
# plotting the interaction
p5 <- ggplot(sed_SAPA,aes(Max.Ht,FluxAvgRep,group=Season, color=Site)) + geom_point(size=2,alpha=.5,position = position_dodge(width=.15)) +
geom_smooth(method = "lm", se = FALSE) +
ylab("Sediment Flux") +
xlab("Maximum Plant Height") +
theme_classic(14)
p5
plot(sedvegglm)
plot(sedvegglm)
sedvegglm <-glm(FluxAvgRep~Max.Ht, family = "poisson", data=sed_SAPA)
sedvegglm
sedvegglm_AIC_text <- paste("AIC: 3788")
sedvegglm_AIC_text
sedvegglm_coefficient_Max.Ht <- paste("Coefficient for Max Height: -0.003517 ")
sedvegglm_coefficient_Max.Ht
library(glmmTMB)
sed_glmm = glmmTMB(FluxAvgRep~Max.Ht + Distance + Avg.Ht + (1|Season) + (1|Site) +(1|Year), family = poisson, data=sed_SAPA)
summary(sed_glmm)
AIC(sed_glmm)
sed_glmmSP = glmmTMB(FluxAvgRep~Max.Ht + Cover + Distance + Avg.Ht + (1|Season) + (1|Year), family = poisson, data=SPsed_veg)
summary(sed_glmmSP)
sed_glmmCM = glmmTMB(FluxAvgRep~Max.Ht + Cover + Distance + Avg.Ht + (1|Season) + (1|Year), family = poisson, data=CMsed_veg)
summary(sed_glmmCM)
sed1_cor <- cor_test(FluxAvgRep, Max.Ht, data=sed_SAPA)
#correlation coefficient
r <- sed1_cor$cor
r
# plotting the interaction
p5 <- ggplot(sed_SAPA,aes(Max.Ht,FluxAvgRep,group=Season, color=Site)) + geom_point(size=2,alpha=.5,position = position_dodge(width=.15)) +
geom_smooth(method = "lm", se = FALSE) +
ylab("Sediment Flux") +
xlab("Maximum Plant Height") +
theme_classic(14)
p5
sedvegglm <-glm(FluxAvgRep~Max.Ht, family = "poisson", data=sed_SAPA)
sedvegglm
sedvegglm_AIC_text <- paste("AIC: 3788")
sedvegglm_AIC_text
sedvegglm_coefficient_Max.Ht <- paste("Coefficient for Max Height: -0.003517 ")
sedvegglm_coefficient_Max.Ht
SAPA_time_space <- ggplot(data=veg, aes(x=Distance, y=Max.Ht, color=Site)) + geom_point()
library(ggplot2)
library(tidyverse)
library(Rmisc)
library(rstatix)
library(tidyr)
library(data.table)
library(dplyr)
library(lme4)
library(stringr)
knitr::opts_knit$set(root.dir = 'C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data')
# load data
dataset_sed <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_sediment_pad_data (project).csv")
dataset_veg <- read.csv("C:/Users/savan/OneDrive/Documents/Code/GitHub/DepositionSFB/data/SFB_1m_vegetation_data (project).csv")
sed <- dataset_sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
sed <- dataset_sed %>%
select(-Date.removed.from.field, -Date.placed.in.field)
sed <- sed %>% mutate(FluxAvgRep = ifelse(is.na(FluxAvgRep), 0, FluxAvgRep))
#sed$Plot.ID <- paste(sed$Transect, sed$Distance)
#veg$Plot.ID <- paste(veg$Transect, veg$Distance)
sed$Season <- str_replace_all(sed$Season, " ", "")
sed$Distance <- str_replace_all(sed$Distance, " ", "")
sed$Transect <- str_replace_all(sed$Transect, " ", "")
sed$Year <- str_replace_all(sed$Year, " ", "")
sed$Month <- str_replace_all(sed$Month, " ", "")
sed$FluxAvgRep <- str_replace_all(sed$FluxAvgRep, " ", "")
#sed$Plot.ID <- str_replace_all(sed$Plot.ID, " ", "")
sed$FluxAvgRep <-as.numeric(sed$FluxAvgRep)
sed$FluxAvgRep <- round(sed$FluxAvgRep)
sed$Year <- as.character(sed$Year)
sed$Distance <-as.numeric(sed$Distance)
veg <- dataset_veg %>% mutate(Avg.Ht = ifelse(is.na(Avg.Ht), 0, Avg.Ht))
veg <- dataset_veg %>% mutate(Max.Ht = ifelse(is.na(Max.Ht), 0, Max.Ht))
veg$Season <- str_replace_all(veg$Season, " ", "")
veg$Distance <- str_replace_all(veg$Distance, " ", "")
veg$Transect <- str_replace_all(veg$Transect, " ", "")
veg$Year <- str_replace_all(veg$Year, " ", "")
veg$Month <- str_replace_all(veg$Month, " ", "")
veg$Year <- as.character(veg$Year)
veg$Cover <-as.numeric(veg$Cover)
veg$Distance <-as.numeric(veg$Distance)
str(sed)
str(veg)
sed_mean <- mean(sed$FluxAvgRep, na.rm = TRUE)
sed_mean
sed_max  <- max(sed$FluxAvgRep, na.rm = TRUE)
sed_max
sed_min  <- min(sed$FluxAvgRep, na.rm = TRUE)
sed_min
sed_sd <-sd(sed$FluxAvgRep, na.rm =TRUE)
sed_sd
SAPA_time_space <- ggplot(data=veg, aes(x=Distance, y=Max.Ht, color=Site)) + geom_point()
SAPA_time_space
sed_space <-ggplot(data=sed, aes(x=Distance, y=FluxAvgRep, color=Site)) +geom_point() + geom_jitter(width = 0.2, height = 0.2, alpha = 0.6) + theme_minimal() +
coord_cartesian(ylim = c(0, 357))
sed_space
sed_time <-ggplot(data=sed, aes(x=Season, y=FluxAvgRep, color=Site)) + geom_point() + geom_jitter(width = 0.2, height = 0.2, alpha = 0.6) + theme_minimal() +
coord_cartesian(ylim = c(0, 357))
sed_time
SAPA_height <- ggplot(veg, aes(x=Max.Ht,fill=Season)) + geom_boxplot()
SAPA_height
SAPA_cover <- ggplot(veg, aes(x=Cover, fill = Season)) + geom_boxplot()
SAPA_cover
SAPA_Site_cover <- ggplot(veg, aes(x= Cover, fill = Site)) + geom_boxplot()
SAPA_Site_cover
SAPA_Site_mxht <- ggplot(veg, aes(x = Max.Ht, fill = Site)) + geom_boxplot()
SAPA_Site_mxht
#check the data for normality, Max.Ht
SAPA_Maxht_Site_Normality <-ggplot(veg, aes(x=Max.Ht)) + geom_histogram(binwidth = 0.5)
SAPA_Maxht_Site_Normality
#check the data for normality, Avg.ht
SAPA_Avght_Site_Normality <-ggplot(veg, aes(x=Avg.Ht)) + geom_histogram(binwidth = 0.5)
SAPA_Avght_Site_Normality
#check the data for normality, Cover
SAPA_Cover_Site_Normality <-ggplot(veg, aes(x=Cover)) + geom_histogram(binwidth = 0.5)
SAPA_Cover_Site_Normality
sed_SAPA <- merge(sed, veg, by = c("Site", "Season", "Distance", "Transect", "Year", "Month"), all = FALSE)
#separating the main dataframe into two site sets
CMsed_veg <- subset(sed_SAPA, Site == "Corte Madera")
#CMsed_veg
SPsed_veg <- subset(sed_SAPA, Site == "San Pablo")
#SPsed_veg
sed_year <- ggplot(sed, aes(x= Year, y= FluxAvgRep, color= Site)) +geom_point()
sed_year
sed_Siteseason <- ggplot(sed, aes(x= Site, y=FluxAvgRep, color = Season)) +geom_point() + geom_boxplot()
sed_Siteseason
sed_site <- ggplot(sed, aes(x=Site, y=FluxAvgRep)) +geom_point() + geom_boxplot()
sed_site
sedvegCM <- ggplot(CMsed_veg, aes(x = Distance, y = FluxAvgRep, color = Season)) + geom_point()
sedvegCM
sedvegSP <- ggplot(SPsed_veg, aes(x = Distance, y = FluxAvgRep, color = Season)) + geom_point()
sedvegSP
sed_site_normality <- ggplot(sed, aes(x=FluxAvgRep)) +geom_histogram(binwidth = 0.5)
sed_site_normality
t.test(Max.Ht~Site,alternative ="two.sided", var.equal = TRUE, data=sed_SAPA)
t.test(FluxAvgRep~Site,alternative ="two.sided", var.equal = TRUE, data=sed_SAPA)
sedvegglm <-glm(FluxAvgRep~Max.Ht, family = "poisson", data=sed_SAPA)
sedvegglm
sedvegglm_AIC_text <- paste("AIC: 3788")
sedvegglm_AIC_text
sedvegglm_coefficient_Max.Ht <- paste("Coefficient for Max Height: -0.003517 ")
sedvegglm_coefficient_Max.Ht
plot(sedvegglm)
library(glmmTMB)
sed_glmm = glmmTMB(FluxAvgRep~Max.Ht + Distance + Avg.Ht + (1|Season) + (1|Site) +(1|Year), family = poisson, data=sed_SAPA)
summary(sed_glmm)
AIC(sed_glmm)
sed_glmmSP = glmmTMB(FluxAvgRep~Max.Ht + Cover + Distance + Avg.Ht + (1|Season) + (1|Year), family = poisson, data=SPsed_veg)
summary(sed_glmmSP)
sed_glmmCM = glmmTMB(FluxAvgRep~Max.Ht + Cover + Distance + Avg.Ht + (1|Season) + (1|Year), family = poisson, data=CMsed_veg)
summary(sed_glmmCM)
sed1_cor <- cor_test(FluxAvgRep, Max.Ht, data=sed_SAPA)
#correlation coefficient
r <- sed1_cor$cor
r
# plotting the interaction
p5 <- ggplot(sed_SAPA,aes(Max.Ht,FluxAvgRep,group=Season, color=Site)) + geom_point(size=2,alpha=.5,position = position_dodge(width=.15)) +
geom_smooth(method = "lm", se = FALSE) +
ylab("Sediment Flux") +
xlab("Maximum Plant Height") +
theme_classic(14)
p5
sed_glmmSP = glmmTMB(FluxAvgRep~Max.Ht + Cover + Distance + (1|Season) + (1|Year), family = poisson, data=SPsed_veg)
summary(sed_glmmSP)
sed_glmmSP = glmmTMB(FluxAvgRep~Max.Ht + Distance + (1|Season) + (1|Year), family = poisson, data=SPsed_veg)
summary(sed_glmmSP)
sed_glmmCM = glmmTMB(FluxAvgRep~Max.Ht + Distance + (1|Season) + (1|Year), family = poisson, data=CMsed_veg)
summary(sed_glmmCM)
